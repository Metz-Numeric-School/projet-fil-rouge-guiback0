<div class="user-dashboard">
  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Chargement du profil...</p>
  </div>

  <!-- Main Content -->
  <div *ngIf="!isLoading && currentUser" class="dashboard-content">
    <!-- Enhanced Header - Only show when on main dashboard -->
    <div *ngIf="selectedTabIndex === 0" class="dashboard-header">
      <h1>
        <mat-icon class="dashboard-icon">account_circle</mat-icon>
        Mon Profil
      </h1>
      <p class="dashboard-subtitle">Consultez et gérez vos informations personnelles et professionnelles</p>
    </div>

    <!-- Navigation Cards - Only show when on main dashboard -->
    <div *ngIf="selectedTabIndex === 0" class="dashboard-grid">
      <!-- Personal Information Card -->
      <mat-card class="dashboard-card" (click)="setActiveTab(1)">
        <mat-card-header>
          <div mat-card-avatar class="card-avatar personal-avatar">
            <mat-icon>person</mat-icon>
          </div>
          <mat-card-title>Informations Personnelles</mat-card-title>
          <mat-card-subtitle>Vos données personnelles et horaires</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p>Consultez vos informations de base, vos horaires de travail et vos rôles dans le système.</p>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button color="primary">
            <mat-icon>arrow_forward</mat-icon>
            Consulter
          </button>
        </mat-card-actions>
      </mat-card>

      <!-- Organization Card -->
      <mat-card class="dashboard-card" (click)="onOrganizationCardClick()">
        <mat-card-header>
          <div mat-card-avatar class="card-avatar" [class.organisation-avatar]="hasOrganization()"
            [class.disabled-avatar]="!hasOrganization()">
            <mat-icon>business</mat-icon>
          </div>
          <mat-card-title>Organisation</mat-card-title>
          <mat-card-subtitle>{{ hasOrganization() ? 'Informations de votre organisation' : 'Aucune organisation' }}
          </mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p *ngIf="hasOrganization()">Consultez les détails de votre organisation d'appartenance.</p>
          <p *ngIf="!hasOrganization()">Aucune organisation n'est associée à votre profil.</p>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button color="primary">
            <mat-icon>arrow_forward</mat-icon>
            Consulter
          </button>
        </mat-card-actions>
      </mat-card>



      <!-- Badges Card -->
      <mat-card class="dashboard-card" (click)="setActiveTab(3)">
        <mat-card-header>
          <div mat-card-avatar class="card-avatar badges-avatar">
            <mat-icon>badge</mat-icon>
          </div>
          <mat-card-title>Badges</mat-card-title>
          <mat-card-subtitle>Vos badges d'accès</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p>Consultez vos badges d'accès actifs et leurs informations.</p>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button color="primary">
            <mat-icon>arrow_forward</mat-icon>
            Consulter
          </button>
        </mat-card-actions>
      </mat-card>


    </div>

  </div>

  <!-- Component Content - Full page when active -->
  <div *ngIf="!isLoading && currentUser && selectedTabIndex !== 0" class="component-content">
    <!-- Back Button -->
    <div class="back-button-container">
      <button mat-raised-button color="primary" (click)="setActiveTab(0)">
        <mat-icon>arrow_back</mat-icon>
        Retour au Menu
      </button>
    </div>

    <!-- Personal Info Component -->
    <app-personal-info *ngIf="selectedTabIndex === 1" [currentUser]="currentUser"></app-personal-info>

    <!-- Organisation Component -->
    <app-organisation *ngIf="selectedTabIndex === 2" [completeProfile]="completeProfile"></app-organisation>


    <!-- Badges Component -->
    <app-badges *ngIf="selectedTabIndex === 3" [completeProfile]="completeProfile"></app-badges>
  </div>

  <!-- Error State -->
  <div *ngIf="!isLoading && !currentUser" class="error-state">
    <mat-icon>error</mat-icon>
    <h2>Erreur de chargement</h2>
    <p>Impossible de charger les informations utilisateur.</p>
    <button mat-raised-button color="primary" (click)="logout()">Retourner à la connexion</button>
  </div>
</div>
