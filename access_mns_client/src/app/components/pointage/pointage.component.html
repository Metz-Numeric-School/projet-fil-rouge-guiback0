<div class="pointage-container">
  <div class="dashboard-header">
    <h1>
      <mat-icon class="dashboard-icon">access_time</mat-icon>
      Pointage
    </h1>
    <p class="dashboard-subtitle">Gérez votre présence et suivez votre temps de travail</p>
  </div>

  <!-- Loading indicator -->
  <div class="loading-section" *ngIf="state.isLoading">
    <mat-card class="loading-card">
      <mat-card-content>
        <div class="loading-content">
          <mat-spinner diameter="50"></mat-spinner>
          <h3>Chargement des badgeuses...</h3>
          <p>Récupération des informations de pointage</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Main content -->
  <div class="main-content" *ngIf="!state.isLoading">
    <!-- Status and working time display -->
    <app-working-time-status
      [userStatus]="state.userStatus"
      [workingTimeToday]="state.workingTimeToday"
      [workingStartTime]="state.workingStartTime">
    </app-working-time-status>

    <!-- Error display -->
    <app-error-display
      [errorMessage]="state.lastError"
      (retry)="retryLoad()"
      (dismiss)="dismissError()">
    </app-error-display>


    <!-- Badgeuses sections -->
    <div class="badgeuses-sections" *ngIf="state.badgeuses.length > 0">
      
      <!-- Principal badgeuses -->
      <div class="badgeuses-section" *ngIf="getPrincipalBadgeuses().length > 0">
        <h2 class="section-title">
          <mat-icon color="primary">star</mat-icon>
          Badgeuses principales ({{ getPrincipalBadgeuses().length }})
        </h2>
        <div class="badgeuses-grid">
          <app-badgeuse-card
            *ngFor="let badgeuse of getPrincipalBadgeuses(); trackBy: trackByBadgeuseId"
            [badgeuse]="badgeuse"
            [userStatus]="state.userStatus"
            [isSelected]="false"
            [isProcessing]="state.isProcessingPointage && state.selectedBadgeuse?.id === badgeuse.id"
            (toggleSelect)="performDirectPointage($event)">
          </app-badgeuse-card>
        </div>
      </div>

      <!-- Secondary badgeuses -->
      <div class="badgeuses-section" *ngIf="getSecondaryBadgeuses().length > 0">
        <h2 class="section-title">
          <mat-icon color="accent">work</mat-icon>
          Badgeuses secondaires ({{ getSecondaryBadgeuses().length }})
        </h2>
        <div class="badgeuses-grid">
          <app-badgeuse-card
            *ngFor="let badgeuse of getSecondaryBadgeuses(); trackBy: trackByBadgeuseId"
            [badgeuse]="badgeuse"
            [userStatus]="state.userStatus"
            [isSelected]="false"
            [isProcessing]="state.isProcessingPointage && state.selectedBadgeuse?.id === badgeuse.id"
            (toggleSelect)="performDirectPointage($event)">
          </app-badgeuse-card>
        </div>
      </div>
    </div>

    <!-- Empty state -->
    <mat-card class="empty-state" *ngIf="!state.isLoading && state.badgeuses.length === 0 && !state.lastError">
      <mat-card-content>
        <div class="empty-content">
          <mat-icon class="empty-icon" color="accent">devices_off</mat-icon>
          <h3>Aucune badgeuse disponible</h3>
          <p>Aucune badgeuse n'est actuellement accessible pour votre compte.</p>
          <p>Veuillez contacter l'administrateur si vous pensez qu'il s'agit d'une erreur.</p>
        </div>
      </mat-card-content>
      <mat-card-actions>
        <button mat-raised-button color="primary" (click)="retryLoad()">
          <mat-icon>refresh</mat-icon>
          Actualiser
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>